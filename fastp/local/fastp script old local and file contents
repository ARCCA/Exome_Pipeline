###fastp###

##This code is used to assess and trim gzipped fastq files, it removes the adapter sequences which are stored in Adaptersequences/Inputadapter.fa

#Thr acc_list.txt is a text file which contains the identifiers for each sequence. It looks like this: 
NG0921001_EKDN210018941-1A_HN2MGDSX2_L2_
NG0921002_EKDN210018942-1A_HN2MGDSX2_L3_
NG0921003_EKDN210018943-1A_HN2MGDSX2_L3_
NG0921004_EKDN210018944-1A_HMYL3DSX2_L4_
NG0921005_EKDN210018945-1A_HN2MGDSX2_L2_
NG0921006_EKDN210018946-1A_HN2MGDSX2_L2_
NG0921007_EKDN210018947-1A_HN2MGDSX2_L3_
NG0921008_EKDN210018948-1A_HN2MGDSX2_L3_
NG0921009_EKDN210018949-1A_HN2MGDSX2_L3_
NG0921010_EKDN210018950-1A_HN2MGDSX2_L2_
NG0921011_EKDN210018951-1A_HN2MGDSX2_L3_
NG0921012_EKDN210018952-1A_HN2MGDSX2_L3_
NG0921013_EKDN210018953-1A_HN2MGDSX2_L2_
NG0921014_EKDN210018954-1A_HN2MGDSX2_L3_
NG0921015_EKDN210018955-1A_HN2MGDSX2_L3_
NG0921016_EKDN210018956-1A_HN2MGDSX2_L2_
NG0921017_EKDN210018957-1A_HN2MGDSX2_L2_
NG0921018_EKDN210018958-1A_HN2MGDSX2_L2_
NG0921019_EKDN210018959-1A_HN2MGDSX2_L2_
NG0921020_EKDN210018960-1A_HN2MGDSX2_L2_
NG0921021_EKDN210018961-1A_HN2MGDSX2_L2_
NG0921022_EKDN210018962-1A_HMYL3DSX2_L4_
NG0921024_EKDN210018964-1A_HMYL3DSX2_L4_
NG0921025_EKDN210018965-1A_HN2MGDSX2_L3_
NG0921026_EKDN210018966-1A_HN2MGDSX2_L2_
NG0921027_EKDN210018967-1A_HN2MGDSX2_L3_
NG0921028_EKDN210018968-1A_HN2MGDSX2_L3_
NG0921029_EKDN210018969-1A_HN2MGDSX2_L3_
NG0921030_EKDN210018970-1A_HN2MGDSX2_L2_
NG0921031_EKDN210018971-1A_HN2MGDSX2_L3_
NG0921032_EKDN210018972-1A_HN2MGDSX2_L3_
NG0921033_EKDN210018973-1A_HN2MGDSX2_L3_
NG0921035_EKDN210018974-1A_HMYL3DSX2_L4_

## The Inputadapter.fa looks like this:
>Illumina forward adapter - read 1
AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT

>Illumina reverse adapter - read 2 
GATCGGAAGAGCACACGTCTGAACTCCAGTCACGGATGACTATCTCGTATGCCGTCTTCTGCTTG


cat acc_list.txt | parallel -j 1 "fastp -i RawPEreads/{}1.fq.gz -I RawPEreads/{}2.fq.gz -o TrimmedPEreads/{}1.trimmed.fq.gz -O TrimmedPEreads/{}2.trimmed.fq.gz --html Output/html_output/{.}pairhtml --json Output/json_output/{.}pairjson --failed_out Output/Failedoutput/{.} --unpaired1 Output/Unpairedreads/Unpaired_read1/{.}1.unpaired1.fq.gz --unpaired2 Output/Unpairedreads/Unpaired_read2/{.}2.unpaired2.fq.gz -m --merged_out Output/Mergedreads/{.}merged.fq.gz --adapter_fasta Adaptersequences/Inputadapter.fa --failed_out Output/failedoutput/{.}failed.fq.gz"
